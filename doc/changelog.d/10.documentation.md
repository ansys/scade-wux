refactor: Refactor the classes and code to enhance reusability and testability